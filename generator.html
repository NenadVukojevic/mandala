<html>
<style>
    body,
    html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        background-color: black;
    }

    canvas {
        display: block;
    }
</style>

<body>
    <input type="range" id="sizeRange" min="100" max="600" value="150"><input type="text" id="sizeRangeValue">
    <br>
    <input type="range" id="sizeOuter" min="16" max="80" value="22"><input type="text" id="sizeOuterValue">
    <br>
    <textarea id="arcsValue"></textarea>
    <br>
    <input id="copyBtn" type="button" value="copy">
    <br>
    <canvas id="myCanvas" width="1200" height="1200"></canvas>

    <script type="module">

        import { generateShapes } from './generators/border_pearl.js';
        const canvas = document.getElementById('myCanvas');
        const ctx = canvas.getContext('2d');

        const sizeRange = document.getElementById('sizeRange');
        const sizeRangeValue = document.getElementById('sizeRangeValue');

        const sizeOuter = document.getElementById('sizeOuter');
        const sizeOuterValue = document.getElementById('sizeOuterValue');

        const arcsValue = document.getElementById('arcsValue');

        const copyBtn = document.getElementById('copyBtn');

        function drawArcsFast(arcs) {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            arcs.forEach(arc => {
                ctx.beginPath();
                ctx.arc(
                    arc.x,                 // x-coordinate of the center
                    arc.y,                 // y-coordinate of the center
                    arc.radius,                 // radius of the arc
                    arc.startAngle,             // start angle in radians
                    arc.endAngle
                );
                ctx.strokeStyle = arc.color || 'white';
                ctx.lineWidth = arc.lineWidth || 2;
                ctx.stroke();
            });
        }

        sizeRange.addEventListener('input', function () {
            sizeRangeValue.value = sizeRange.value;
            /*
            const arcs = generateShapes(300, 300, sizeRange.value, sizeOuter.value);
            arcsValue.value = arcs.map(obj => JSON.stringify(obj, null, 2)).join('\n\n');
            drawArcsFast(arcs);
            */
            redraw();
        });

        sizeOuter.addEventListener('input', function () {
            sizeOuterValue.value = sizeOuter.value;
            redraw();
        })

        const redraw = () => {
            const arcs = generateShapes(300, 300, sizeRange.value, sizeOuter.value);
            arcsValue.value = arcs.map(obj => JSON.stringify(obj, null, 2)).join('\n,\n');
            drawArcsFast(arcs);
        }

        sizeRangeValue.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                sizeRange.value = sizeRangeValue.value;
                redraw();
            }
        })

        sizeOuterValue.addEventListener('keydown', function (event) {
            if (event.key === 'Enter') {
                sizeOuter.value = sizeOuterValue.value;
                redraw();
            }
        })

        copyBtn.addEventListener('click', function(event){
            navigator.clipboard.writeText(arcsValue.value);
        })

        const arcs = generateShapes(300, 300, sizeRange.value, sizeOuter.value);
        drawArcsFast(arcs);
        console.log(arcs)
    </script>
</body>

</html>